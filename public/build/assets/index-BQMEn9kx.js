import{r as x,a as I,j as e,H as W,t as d}from"./app-6bBVh81h.js";import{A as Y,t as g}from"./app-layout-UsWctk4Z.js";import{B as s}from"./button-BkVP_mrO.js";import{d as Z}from"./index-D329iiHL.js";import{D as y,a as N,b as v,c as w,d as C,e as D}from"./dialog-DV3fwRoB.js";import{I as o}from"./input-BKa16iTx.js";import{L as l}from"./label-hoL9B20y.js";import{S as _,a as S,b as T,c as F,d as m}from"./select-CtnOCNuX.js";import{P as B}from"./plus-kaWgOL_K.js";import{P as ee}from"./pencil-CpJ14bZc.js";import{T as ae}from"./trash-2-B8U6d4l0.js";/* empty css            */import"./index-CbZt69Ef.js";import"./index-CLF09JFy.js";import"./index-Bbf2PDuR.js";import"./index-CMWG4mbA.js";import"./index-Bqs3Wh3Q.js";import"./app-logo-icon-CbAe46uy.js";import"./index-D-OB9Yqx.js";import"./check-DF6bN3B3.js";const te=[{title:"Dashboard",href:Z().url},{title:"Transaksi",href:g.index().url}];function ve({transaksis:n,categories:q}){const[V,j]=x.useState(!1),[K,b]=x.useState(!1),[z,k]=x.useState(!1),[H,h]=x.useState(!1),[u,f]=x.useState(null),[O,L]=x.useState(q),A=()=>new Date().toISOString().split("T")[0],r=I({nama_transaksi:"",nominal:"",tanggal:A(),jenis:"pengeluaran",category_id:""}),t=I({nama_transaksi:"",nominal:"",tanggal:"",jenis:"pemasukan",category_id:""}),c=I({name:""}),M=()=>{r.setData({nama_transaksi:"",nominal:"",tanggal:A(),jenis:"pengeluaran",category_id:""}),j(!0)},G=async a=>{a.preventDefault();try{const i=await fetch("/categories",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]')?.getAttribute("content")||""},body:JSON.stringify({name:c.data.name})});if(!i.ok)throw new Error("Failed to create category");const p=await i.json();L([...O,p]),r.setData("category_id",p.id.toString()),h(!1),c.reset(),d.success("Kategori berhasil ditambahkan!")}catch{d.error("Gagal menambahkan kategori")}},J=a=>{a.preventDefault(),r.post(g.store().url,{onSuccess:()=>{j(!1),r.reset(),d.success("Transaksi berhasil ditambahkan!")},onError:()=>{d.error("Gagal menambahkan transaksi")}})},R=a=>{f(a),t.setData({nama_transaksi:a.nama_transaksi,nominal:a.nominal,tanggal:a.tanggal,jenis:a.jenis,category_id:a.category?.id.toString()||""}),b(!0)},U=a=>{a.preventDefault(),u&&t.put(g.update(u.id).url,{onSuccess:()=>{b(!1),t.reset(),f(null),d.success("Transaksi berhasil diupdate!")},onError:()=>{d.error("Gagal mengupdate transaksi")}})},X=a=>{f(a),k(!0)},$=()=>{u&&t.delete(g.destroy(u.id).url,{onSuccess:()=>{k(!1),f(null),d.success("Transaksi berhasil dihapus!")},onError:()=>{d.error("Gagal menghapus transaksi")}})},Q=a=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0,maximumFractionDigits:0}).format(parseFloat(a)),E=a=>{if(!a)return"";const i=parseFloat(a.toString());return isNaN(i)?"":Math.floor(i).toString().replace(/\B(?=(\d{3})+(?!\d))/g,".")},P=(a,i)=>{const p=a.replace(/\./g,"");i.setData({...i.data,nominal:p})};return e.jsxs(Y,{breadcrumbs:te,children:[e.jsx(W,{title:"Transaksi"}),e.jsxs("div",{className:"flex h-full flex-1 flex-col gap-4 p-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Daftar Transaksi"}),e.jsxs(s,{onClick:M,children:[e.jsx(B,{className:"mr-2 h-4 w-4"}),"Tambah Transaksi"]})]}),e.jsxs("div",{className:"overflow-hidden rounded-xl border border-sidebar-border/70 bg-white dark:border-sidebar-border dark:bg-neutral-900",children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"border-b border-sidebar-border/70 bg-neutral-50 dark:border-sidebar-border dark:bg-neutral-800",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-neutral-500 dark:text-neutral-400",children:"No"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-neutral-500 dark:text-neutral-400",children:"Nama Transaksi"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-neutral-500 dark:text-neutral-400",children:"Kategori"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-neutral-500 dark:text-neutral-400",children:"Nominal"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-neutral-500 dark:text-neutral-400",children:"Tanggal"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-neutral-500 dark:text-neutral-400",children:"Jenis"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-neutral-500 dark:text-neutral-400",children:"Aksi"})]})}),e.jsx("tbody",{className:"divide-y divide-sidebar-border/70 dark:divide-sidebar-border",children:n.data.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:7,className:"px-6 py-8 text-center text-neutral-500",children:"Belum ada transaksi"})}):n.data.map((a,i)=>e.jsxs("tr",{className:"hover:bg-neutral-50 dark:hover:bg-neutral-800/50",children:[e.jsx("td",{className:"whitespace-nowrap px-6 py-4 text-sm text-neutral-900 dark:text-neutral-100",children:(n.current_page-1)*n.per_page+i+1}),e.jsx("td",{className:"whitespace-nowrap px-6 py-4 text-sm text-neutral-900 dark:text-neutral-100",children:a.nama_transaksi}),e.jsx("td",{className:"whitespace-nowrap px-6 py-4 text-sm text-neutral-900 dark:text-neutral-100",children:a.category?e.jsx("span",{className:"inline-flex items-center rounded-full bg-blue-100 px-2.5 py-0.5 text-xs font-medium text-blue-800 dark:bg-blue-900 dark:text-blue-200",children:a.category.name}):e.jsx("span",{className:"text-xs text-neutral-400",children:"-"})}),e.jsx("td",{className:"whitespace-nowrap px-6 py-4 text-sm text-neutral-900 dark:text-neutral-100",children:Q(a.nominal)}),e.jsx("td",{className:"whitespace-nowrap px-6 py-4 text-sm text-neutral-900 dark:text-neutral-100",children:new Date(a.tanggal).toLocaleDateString("id-ID")}),e.jsx("td",{className:"whitespace-nowrap px-6 py-4 text-sm",children:e.jsx("span",{className:`inline-flex rounded-full px-2 py-1 text-xs font-semibold ${a.jenis==="pemasukan"?"bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-400":"bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-400"}`,children:a.jenis})}),e.jsx("td",{className:"whitespace-nowrap px-6 py-4 text-sm",children:e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(s,{variant:"outline",size:"sm",onClick:()=>R(a),children:e.jsx(ee,{className:"h-4 w-4"})}),e.jsx(s,{variant:"outline",size:"sm",onClick:()=>X(a),className:"text-red-600 hover:bg-red-50 hover:text-red-700 dark:text-red-400 dark:hover:bg-red-900/20",children:e.jsx(ae,{className:"h-4 w-4"})})]})})]},a.id))})]})}),n.last_page>1&&e.jsx("div",{className:"border-t border-sidebar-border/70 px-6 py-4 dark:border-sidebar-border",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"text-sm text-neutral-500",children:["Menampilkan"," ",(n.current_page-1)*n.per_page+1," ","-"," ",Math.min(n.current_page*n.per_page,n.total)," ","dari ",n.total," transaksi"]}),e.jsx("div",{className:"flex space-x-2",children:Array.from({length:n.last_page},(a,i)=>i+1).map(a=>e.jsx("a",{href:g.index({query:{page:a}}).url,children:e.jsx(s,{variant:a===n.current_page?"default":"outline",size:"sm",children:a})},a))})]})})]})]}),e.jsx(y,{open:V,onOpenChange:j,children:e.jsxs(N,{children:[e.jsxs(v,{children:[e.jsx(w,{children:"Tambah Transaksi"}),e.jsx(C,{children:"Isi form di bawah untuk menambahkan transaksi baru"})]}),e.jsxs("form",{onSubmit:J,children:[e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(l,{htmlFor:"create-nama",children:"Nama Transaksi"}),e.jsx(o,{id:"create-nama",value:r.data.nama_transaksi,onChange:a=>r.setData("nama_transaksi",a.target.value),required:!0}),r.errors.nama_transaksi&&e.jsx("p",{className:"text-sm text-red-600",children:r.errors.nama_transaksi})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(l,{htmlFor:"create-nominal",children:"Nominal"}),e.jsx(o,{id:"create-nominal",type:"text",value:E(r.data.nominal),onChange:a=>P(a.target.value,r),placeholder:"0",required:!0}),r.errors.nominal&&e.jsx("p",{className:"text-sm text-red-600",children:r.errors.nominal})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(l,{htmlFor:"create-tanggal",children:"Tanggal"}),e.jsx(o,{id:"create-tanggal",type:"date",value:r.data.tanggal,onChange:a=>r.setData("tanggal",a.target.value),required:!0}),r.errors.tanggal&&e.jsx("p",{className:"text-sm text-red-600",children:r.errors.tanggal})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(l,{htmlFor:"create-jenis",children:"Jenis"}),e.jsxs(_,{value:r.data.jenis,onValueChange:a=>r.setData("jenis",a),children:[e.jsx(S,{id:"create-jenis",children:e.jsx(T,{})}),e.jsxs(F,{children:[e.jsx(m,{value:"pemasukan",children:"Pemasukan"}),e.jsx(m,{value:"pengeluaran",children:"Pengeluaran"})]})]}),r.errors.jenis&&e.jsx("p",{className:"text-sm text-red-600",children:r.errors.jenis})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(l,{htmlFor:"create-category",children:"Kategori (Opsional)"}),e.jsxs(s,{type:"button",variant:"ghost",size:"sm",onClick:()=>h(!0),className:"h-auto py-1 px-2 text-xs",children:[e.jsx(B,{className:"h-3 w-3 mr-1"}),"Tambah Baru"]})]}),e.jsxs(_,{value:r.data.category_id||void 0,onValueChange:a=>r.setData("category_id",a),children:[e.jsx(S,{id:"create-category",children:e.jsx(T,{placeholder:"Pilih kategori (opsional)"})}),e.jsx(F,{children:O.map(a=>e.jsx(m,{value:a.id.toString(),children:a.name},a.id))})]}),r.errors.category_id&&e.jsx("p",{className:"text-sm text-red-600",children:r.errors.category_id})]})]}),e.jsxs(D,{children:[e.jsx(s,{type:"button",variant:"outline",onClick:()=>j(!1),children:"Batal"}),e.jsx(s,{type:"submit",disabled:r.processing,children:"Simpan"})]})]})]})}),e.jsx(y,{open:K,onOpenChange:b,children:e.jsxs(N,{children:[e.jsxs(v,{children:[e.jsx(w,{children:"Edit Transaksi"}),e.jsx(C,{children:"Ubah data transaksi di bawah"})]}),e.jsxs("form",{onSubmit:U,children:[e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(l,{htmlFor:"edit-nama",children:"Nama Transaksi"}),e.jsx(o,{id:"edit-nama",value:t.data.nama_transaksi,onChange:a=>t.setData("nama_transaksi",a.target.value),required:!0}),t.errors.nama_transaksi&&e.jsx("p",{className:"text-sm text-red-600",children:t.errors.nama_transaksi})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(l,{htmlFor:"edit-nominal",children:"Nominal"}),e.jsx(o,{id:"edit-nominal",type:"text",value:E(t.data.nominal),onChange:a=>P(a.target.value,t),placeholder:"0",required:!0}),t.errors.nominal&&e.jsx("p",{className:"text-sm text-red-600",children:t.errors.nominal})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(l,{htmlFor:"edit-tanggal",children:"Tanggal"}),e.jsx(o,{id:"edit-tanggal",type:"date",value:t.data.tanggal,onChange:a=>t.setData("tanggal",a.target.value),required:!0}),t.errors.tanggal&&e.jsx("p",{className:"text-sm text-red-600",children:t.errors.tanggal})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(l,{htmlFor:"edit-jenis",children:"Jenis"}),e.jsxs(_,{value:t.data.jenis,onValueChange:a=>t.setData("jenis",a),children:[e.jsx(S,{id:"edit-jenis",children:e.jsx(T,{})}),e.jsxs(F,{children:[e.jsx(m,{value:"pemasukan",children:"Pemasukan"}),e.jsx(m,{value:"pengeluaran",children:"Pengeluaran"})]})]}),t.errors.jenis&&e.jsx("p",{className:"text-sm text-red-600",children:t.errors.jenis})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(l,{htmlFor:"edit-category",children:"Kategori (Opsional)"}),e.jsxs(s,{type:"button",variant:"ghost",size:"sm",onClick:()=>h(!0),className:"h-auto py-1 px-2 text-xs",children:[e.jsx(B,{className:"h-3 w-3 mr-1"}),"Tambah Baru"]})]}),e.jsxs(_,{value:t.data.category_id||void 0,onValueChange:a=>t.setData("category_id",a),children:[e.jsx(S,{id:"edit-category",children:e.jsx(T,{placeholder:"Pilih kategori (opsional)"})}),e.jsx(F,{children:O.map(a=>e.jsx(m,{value:a.id.toString(),children:a.name},a.id))})]}),t.errors.category_id&&e.jsx("p",{className:"text-sm text-red-600",children:t.errors.category_id})]})]}),e.jsxs(D,{children:[e.jsx(s,{type:"button",variant:"outline",onClick:()=>b(!1),children:"Batal"}),e.jsx(s,{type:"submit",disabled:t.processing,children:"Update"})]})]})]})}),e.jsx(y,{open:z,onOpenChange:k,children:e.jsxs(N,{children:[e.jsxs(v,{children:[e.jsx(w,{children:"Hapus Transaksi"}),e.jsxs(C,{children:['Apakah Anda yakin ingin menghapus transaksi "',u?.nama_transaksi,'"? Tindakan ini tidak dapat dibatalkan.']})]}),e.jsxs(D,{children:[e.jsx(s,{type:"button",variant:"outline",onClick:()=>k(!1),children:"Batal"}),e.jsx(s,{type:"button",variant:"destructive",onClick:$,disabled:t.processing,children:"Hapus"})]})]})}),e.jsx(y,{open:H,onOpenChange:h,children:e.jsxs(N,{children:[e.jsxs(v,{children:[e.jsx(w,{children:"Tambah Kategori Baru"}),e.jsx(C,{children:"Buat kategori baru untuk mengorganisir transaksi Anda"})]}),e.jsxs("form",{onSubmit:G,children:[e.jsx("div",{className:"grid gap-4 py-4",children:e.jsxs("div",{className:"grid gap-2",children:[e.jsx(l,{htmlFor:"category-name",children:"Nama Kategori"}),e.jsx(o,{id:"category-name",value:c.data.name,onChange:a=>c.setData("name",a.target.value),placeholder:"Misal: Makanan, Transport, Belanja",required:!0}),c.errors.name&&e.jsx("p",{className:"text-sm text-red-600",children:c.errors.name})]})}),e.jsxs(D,{children:[e.jsx(s,{type:"button",variant:"outline",onClick:()=>h(!1),children:"Batal"}),e.jsx(s,{type:"submit",disabled:c.processing,children:"Simpan"})]})]})]})})]})}export{ve as default};
